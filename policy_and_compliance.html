<!DOCTYPE html>
<html lang="ru-RU" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EV News</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    /* 主题颜色变量 */
    :root, html[data-theme="dark"] {
        --bg-main: #0d1117;
        --card-bg: #161b22;
        --card-border: #30363d;
        --text-primary: #c9d1d9;
        --text-secondary: #8b949e;
        --text-accent: #58a6ff;
        --accent-color: #00FFFF;
        --button-bg: #21262d;
        --indicator-active: #00FFFF;
        --indicator-inactive: #30363d;
        --stats-bg: rgba(33, 38, 45, 0.5);
        --nav-bg: rgba(33, 38, 45, 0.9);
        --nav-hover-bg: var(--accent-color);
        --nav-hover-color: var(--bg-main);
    }

    html[data-theme="light"] {
        --bg-main: #ffffff;
        --card-bg: #fdfdfd;
        --card-border: #e1e4e8;
        --text-primary: #24292e;
        --text-secondary: #586069;
        --text-accent: #0366d6;
        --accent-color: #007BFF;
        --button-bg: #f6f8fa;
        --indicator-active: #007BFF;
        --indicator-inactive: #d1d5da;
        --stats-bg: rgba(246, 248, 250, 0.8);
        --nav-bg: rgba(255, 255, 255, 0.8);
        --nav-hover-bg: var(--accent-color);
        --nav-hover-color: #ffffff;
    }

    html[data-theme="gray"] {
        --bg-main: #f0f2f5;
        --card-bg: #ffffff;
        --card-border: #d9d9d9;
        --text-primary: #333333;
        --text-secondary: #666666;
        --text-accent: #0056b3;
        --accent-color: #006ae0;
        --button-bg: #e9ecef;
        --indicator-active: #0056b3;
        --indicator-inactive: #b0b0b0;
        --stats-bg: rgba(233, 236, 239, 0.8);
        --nav-bg: rgba(233, 236, 239, 0.9);
        --nav-hover-bg: var(--accent-color);
        --nav-hover-color: #ffffff;
    }

    /* --- 浮动控制面板样式 --- */
    .top-controls {
        padding: 10px 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        position: relative; /* 默认相对定位 */
        z-index: 1000;
        transition: all 0.3s ease-in-out;
    }

    /* 滚动时应用的粘性定位样式 */
    .top-controls.sticky {
        position: fixed; /* 固定在视口顶部 */
        top: 0;
        left: 0;
        right: 0;
        background-color: var(--nav-bg); /* 带透明度的背景 */
        backdrop-filter: blur(5px); /* 毛玻璃效果 */
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        padding: 8px 15px;
    }

    .theme-selector select, .language-selector select {
        padding: 6px 10px;
        border-radius: 5px;
        border: 1px solid var(--card-border);
        background: var(--button-bg);
        color: var(--text-accent);
        font-weight: 500;
        cursor: pointer;
        outline: none;
        font-size: 0.9rem;
        transition: background 0.3s, color 0.3s, border-color 0.3s;
    }
    /* -------------------------------------------------- */

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
                     'Helvetica Neue', Arial, sans-serif;
        background: var(--bg-main);
        color: var(--text-primary);
        line-height: 1.5;
        /* 移除了顶部内边距，交由 .top-controls 控制 */
        padding: 0 15px 15px;
        max-width: 1200px;
        margin: 0 auto;
        min-height: 100vh;
        font-size: 15px;
        position: relative;
        transition: background 0.3s, color 0.3s;
    }

    .header-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        margin-bottom: 15px;
        margin-top: 15px; /* 添加了顶部外边距，与控制面板隔开 */
    }

    .header-container h2 { font-size: 1.3rem; font-weight: 700; color: var(--accent-color); }
    .highlights h2, .news-title { font-size: 1.1rem; font-weight: 600; color: var(--text-primary); }
    .highlight-item { font-size: 0.95rem; font-weight: 500; }
    .news-content {
        font-size: 0.9rem;
        font-weight: 400;
        margin-bottom: 20px;
        color: var(--text-secondary);
        line-height: 1.7;
        background: var(--card-bg);
        padding: 15px;
        hyphens: auto;
        overflow-wrap: break-word;
        word-wrap: break-word;
        word-break: break-word;
        border: 1px solid var(--card-border);
        border-radius: 8px;
    }
    footer { font-size: 0.75rem; font-weight: 400; color: var(--text-secondary); }
    .header-logo { width: 80px; height: 80px; margin-bottom: 5px; }
    .header-logo path { transition: fill 0.3s; }
    header { margin: 20px 0; padding-bottom: 15px; border-bottom: 2px solid var(--accent-color); position: relative; }
    h1 { color: var(--accent-color); font-size: 2.2rem; margin-bottom: 8px; text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1); position: relative; display: inline-block; padding: 0 15px; }
    h1:after { content: ''; position: absolute; bottom: -8px; left: 50%; transform: translateX(-50%); width: 80px; height: 3px; background: var(--accent-color); border-radius: 2px; }
    /* stats-bar 的样式已存在，无需修改 */
    .stats-bar, .meta-info { font-size: 0.8rem; display: flex; justify-content: space-between; padding: 8px; background: var(--stats-bg); border-radius: 8px; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05); margin: 8px 0; border: 1px solid var(--card-border); }
    .stat-item { display: flex; align-items: center; gap: 6px; color: var(--text-secondary); }
    .category { font-weight: bold; background: var(--button-bg); padding: 4px 8px; border-radius: 20px; display: inline-flex; align-items: center; gap: 6px; color: var(--text-accent); border: 1px solid var(--card-border); }
    .category i { font-size: 0.8em; }
    .date { display: flex; align-items: center; gap: 6px; font-weight: 400; color: var(--text-secondary); }
    .date i { color: var(--accent-color); font-size: 1em; }
    .highlights { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 25px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); border: 1px solid var(--card-border); }
    .highlights h2 { color: var(--accent-color); margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px dashed var(--card-border); display: flex; align-items: center; gap: 8px; }
    .highlights h2 i { color: var(--accent-color); }
    .highlights h2:before { content: ''; display: block; width: 6px; height: 28px; background: var(--accent-color); border-radius: 3px; }
    .highlight-item { font-size: 0.95rem; font-weight: 500; margin: 10px 0; padding: 8px; background: var(--button-bg); border-left: 3px solid var(--accent-color); border-radius: 0 6px 6px 0; display: flex; justify-content: space-between; align-items: center; transition: all 0.3s ease; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05); color: var(--text-primary); }
    html[data-theme="dark"] .highlight-item:hover { background: rgba(0, 255, 255, 0.1); transform: translateX(5px); box-shadow: 0 3px 8px rgba(0, 255, 255, 0.1); }
    html[data-theme="light"] .highlight-item:hover { background: rgba(0, 123, 255, 0.1); transform: translateX(5px); box-shadow: 0 3px 8px rgba(0, 123, 255, 0.1); }
    html[data-theme="gray"] .highlight-item:hover { background: rgba(0, 86, 179, 0.1); transform: translateX(5px); box-shadow: 0 3px 8px rgba(0, 86, 179, 0.1); }
    .news-item { background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); border: 1px solid var(--card-border); position: relative; overflow: hidden; }
    .news-item:first-child { border-top: none; }
    .news-title { color: var(--text-primary); margin: 10px 0 15px; padding-bottom: 10px; border-bottom: 1px solid var(--card-border); line-height: 1.3; }
    .image-gallery-container {
        position: relative;
        margin-bottom: 15px;
        border-radius: 10px;
        overflow: hidden;
        background: var(--button-bg);
        padding: 10px;
        border: 1px solid var(--card-border);
    }
    .image-gallery {
        display: flex;
        overflow-x: auto;
        scroll-behavior: smooth;
        gap: 15px;
        padding: 8px 0;
        scrollbar-color: var(--accent-color) var(--button-bg);
        scrollbar-width: none;
        border-radius: 8px;
        scroll-snap-type: x mandatory;
    }
    .image-gallery::-webkit-scrollbar { display: none; }

    .image-container {
        flex: 0 0 100%;
        width: 100%;
        min-width: 100%;
        height: 250px;
        display: flex;
        justify-content: center;
        align-items: center;
        background: var(--bg-main);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.5s ease, background-color 0.3s;
        position: relative;
        scroll-snap-align: center;
    }
    .image-container img { width: 100%; height: 100%; object-fit: contain; transition: transform 0.3s ease; display: block; }
    .image-container:hover img { transform: scale(1.03); }
    .image-container::after { content: ''; position: absolute; bottom: 0; left: 0; width: 100%; height: 35%; background: linear-gradient(transparent, rgba(0,0,0,0.4)); z-index: 1; }
    .fullscreen-image { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); display: flex; justify-content: center; align-items: center; z-index: 1001; }
    .fullscreen-image img { max-width: 90%; max-height: 90%; object-fit: contain; cursor: zoom-out; }
    .gallery-nav { position: absolute; top: 50%; transform: translateY(-50%); width: 36px; height: 36px; background: var(--nav-bg); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 3px 8px rgba(0, 0, 0, 0.3); z-index: 10; transition: all 0.3s ease; color: var(--accent-color); font-size: 1.1rem; border: 1px solid var(--card-border); }
    .gallery-nav:hover { background: var(--nav-hover-bg); color: var(--nav-hover-color); transform: translateY(-50%) scale(1.05); }
    .gallery-nav.prev { left: 15px; }
    .gallery-nav.next { right: 15px; }
    .gallery-indicators {
        display: flex;
        justify-content: center;
        gap: 8px;
        margin-top: 8px;
        position: relative;
        z-index: 10;
    }
    .indicator { width: 10px; height: 10px; border-radius: 50%; background: var(--indicator-inactive); cursor: pointer; transition: all 0.3s ease; }
    .indicator.active { background: var(--indicator-active); transform: scale(1.1); }
    .news-content p { margin-bottom: 12px; }
    .source-link { display: inline-flex; align-items: center; text-decoration: none; color: var(--text-accent); font-weight: 600; transition: all 0.3s ease; padding: 0; background: none; box-shadow: none; font-size: 0.95em; margin-left: 4px; vertical-align: baseline; line-height: 1; margin-top: 0 !important; }
    .source-link:hover { color: var(--accent-color); text-decoration: underline; }
    .source-link i { font-size: 0.95em; margin-left: 3px; vertical-align: middle; }
    footer { text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid var(--card-border); background: var(--card-bg); border-radius: 12px; }

    /* --- 返回顶部按钮样式 --- */
    #back-to-top {
        position: fixed; /* 固定定位 */
        bottom: 20px;
        right: 20px;
        width: 45px;
        height: 45px;
        background-color: var(--accent-color);
        color: var(--nav-hover-color);
        border: none;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 999;
        opacity: 0; /* 默认透明 */
        visibility: hidden; /* 默认隐藏 */
        transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        font-size: 1.2rem;
    }
    #back-to-top.show {
        opacity: 1; /* 显示时变为不透明 */
        visibility: visible; /* 显示 */
        transform: translateY(0);
    }
    #back-to-top:hover {
        transform: scale(1.1);
    }
    /* ------------------------------------------- */

    @media (max-width: 768px) {
        body { padding: 0 8px 8px; font-size: 14px; }
        .top-controls { padding: 8px; }
        .top-controls.sticky { padding: 6px 8px; }
        .theme-selector select, .language-selector select {
            padding: 5px 8px;
            font-size: 0.8rem;
        }
        /* ... (其余媒体查询样式保持不变) ... */
    }
</style>

</head>
<body>
<!-- 浮动控制元素的容器 -->
<div class="top-controls" id="top-controls">
    <div class="theme-selector">
        <select id="themeSelect">
            <option value="dark" data-ru="Темная" data-zh="深色" data-en="Dark">深色</option>
            <option value="light" data-ru="Светлая" data-zh="浅色" data-en="Light">浅色</option>
            <option value="gray" data-ru="Серая" data-zh="灰色" data-en="Gray">灰色</option>
        </select>
    </div>
    <div class="language-selector">
        <select id="languageSelect">
            <option value="ru">Русский</option>
            <option value="zh">中文</option>
            <option value="en">English</option>
        </select>
    </div>
</div>

<div class="header-container" id="main-header">
    <svg class="header-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 40" fill="none">
        <path d="M20 40H20.0806C31.129 40 40.0806 31.0887 40.0806 20C40.0806 8.91129 31.1694 0 20.0806 0H20C8.91129 0 0 8.91129 0 20C0 31.0887 8.95161 40 20 40Z"
              fill="#00FFFF"></path>
        <path d="M20.0415 11.2354C18.227 11.2354 17.3399 12.3241 15.7673 14.4208C13.8318 17.0418 11.8963 19.9047 10.6463 21.8402C9.75923 23.2515 9.55762 23.937 9.55762 24.5015C9.55762 25.6708 10.3641 26.3966 11.4125 26.3966C12.3399 26.3966 13.0254 25.8321 14.356 24.7434C16.1705 23.2112 17.9044 21.5983 20.0415 21.5983C22.1786 21.5983 23.9125 23.2112 25.727 24.7434C27.0576 25.8321 27.7431 26.3966 28.6705 26.3966C29.7189 26.3966 30.5254 25.6708 30.5254 24.5015C30.5254 23.937 30.3237 23.2515 29.4366 21.8402C28.1866 19.9047 26.2512 17.0418 24.3157 14.4208C22.7431 12.3241 21.856 11.2354 20.0415 11.2354Z"
              fill="black"></path>
    </svg>
    <header>
        <h2 id="categorySummary">Автомобильная отрасль сталкивается с вызовами из-за тарифов и норм выбросов.</h2>
    </header>
</div>

<!-- 新增：在这里添加 stats-bar 统计信息栏 -->
<div class="stats-bar">
    <div class="stat-item">
        <i class="fas fa-file-alt"></i>
        <span>
            <span id="wordsCount"
                  data-ru="90"
                  data-zh="164"
                  data-en="105">
                90
            </span>
            <span id="wordsText"
                  data-ru="Слов"
                  data-zh="字"
                  data-en="Words">
                Слов
            </span>
        </span>
    </div>
    <div class="stat-item">
        <i class="fas fa-clock"></i>
        <span>
            <span id="minsCount"
                  data-ru="1"
                  data-zh="1"
                  data-en="1">
                1
            </span>
            <span id="minsText"
                  data-ru="Мин"
                  data-zh="分"
                  data-en="Mins">
                Мин
            </span>
        </span>
    </div>
</div>
<!-- stats-bar 添加结束 -->


<!-- 主体内容 -->

<section class="highlights">
    <h2><i class="fas fa-star"></i> <span id="highlightsText">Основные моменты</span>
    </h2>
    
    <div class="highlight-item" data-ru="Общественность была привлечена к ответственности за разрядку мошеннических устройств" data-zh="大众因排放作弊装置被欧盟法院裁定担责" data-en="The public has been held responsible for the discharge of fraudulent devices">
        <span>Общественность была привлечена к ответственности за разрядку мошеннических устройств <a href="https://auto.gasgoo.com/news/202508/6I70430852C109.shtml" class="source-link">↗</a></span>
    </div>
    
    <div class="highlight-item" data-ru="Таможенные пошлины в Мааде с квартальным убытком" data-zh="关税致马自达季度亏损" data-en="Customs duties to Maada quarterly loss">
        <span>Таможенные пошлины в Мааде с квартальным убытком <a href="https://auto.gasgoo.com/news/202508/6I70430835C109.shtml" class="source-link">↗</a></span>
    </div>
    
</section>



<article class="news-item">
    <h2 class="news-title" data-ru="Европейский суд постановил, что Volkswagen несет ответственность за установку устройств для манипуляции выбросами." data-zh="欧盟最高法院裁定大众需为排放作弊装置承担责任"
        data-en="The EU's highest court ruled that Volkswagen must take responsibility for emission cheating devices.">Европейский суд постановил, что Volkswagen несет ответственность за установку устройств для манипуляции выбросами.</h2>
    <div class="meta-info">
            <span class="date">
                <i class="fas fa-calendar-alt"></i>
                2025-08-06
            </span>
    </div>

    
    <div class="image-gallery-container">
        <div class="image-gallery" id="gallery-1">
            
            <div class="image-container">
                <img src="https://imagecn.gasgoo.com/moblogo/News/UEditor/image/20250806/6389007555646679895240056.jpg" alt="新闻配图">
            </div>
            
        </div>
        <div class="gallery-nav prev" onclick="scrollGallery('gallery-1', -1)">
            <i class="fas fa-chevron-left"></i>
        </div>
        <div class="gallery-nav next" onclick="scrollGallery('gallery-1', 1)">
            <i class="fas fa-chevron-right"></i>
        </div>
        <div class="gallery-indicators" id="indicators-1"></div>
    </div>
    

    <div class="news-content" data-ru="Европейский суд постановил, что автопроизводители, включая Volkswagen, даже если их автомобили соответствуют стандартам ЕС, обязаны нести юридическую ответственность за использование незаконных устройств для манипулирования выбросами. Сумма компенсации должна в полной мере отражать причинённый ущерб."
         data-zh="欧盟法院裁定大众等车企即便车辆符合欧盟标准，仍需为使用非法的排放作弊装置承担法律责任，赔偿金额需充分反映所造成的损害。" data-en="The EU Court ruled that automakers such as Volkswagen must bear legal liability for using illegal emissions cheating devices even if their vehicles comply with EU standards, and the compensation amount must fully reflect the damage caused.">
        Европейский суд постановил, что автопроизводители, включая Volkswagen, даже если их автомобили соответствуют стандартам ЕС, обязаны нести юридическую ответственность за использование незаконных устройств для манипулирования выбросами. Сумма компенсации должна в полной мере отражать причинённый ущерб.
        <a href="https://auto.gasgoo.com/news/202508/6I70430852C109.shtml" class="source-link" style="display: inline-block; margin-top: 15px;">↗</a>
    </div>
</article>

<article class="news-item">
    <h2 class="news-title" data-ru="Чистый квартальный убыток MACDA составил $286 млн из-за тарифов США" data-zh="马自达因美国关税影响季度净亏损2.86亿美元"
        data-en="MACDA net quarterly loss of $286 million due to United States tariffs">Чистый квартальный убыток MACDA составил $286 млн из-за тарифов США</h2>
    <div class="meta-info">
            <span class="date">
                <i class="fas fa-calendar-alt"></i>
                2025-08-06
            </span>
    </div>

    
    <div class="image-gallery-container">
        <div class="image-gallery" id="gallery-2">
            
            <div class="image-container">
                <img src="https://imagecn.gasgoo.com/moblogo/News/UEditor/image/20250806/6389007176837012826686149.png" alt="新闻配图">
            </div>
            
        </div>
        <div class="gallery-nav prev" onclick="scrollGallery('gallery-2', -1)">
            <i class="fas fa-chevron-left"></i>
        </div>
        <div class="gallery-nav next" onclick="scrollGallery('gallery-2', 1)">
            <i class="fas fa-chevron-right"></i>
        </div>
        <div class="gallery-indicators" id="indicators-2"></div>
    </div>
    

    <div class="news-content" data-ru="Mazda пострадала от повышения США импортных пошлин на автомобили, квартальный чистый убыток составил 286 миллионов долларов. Ожидается, что чистая прибыль за текущий финансовый год значительно снизится. Компания корректирует экспортную стратегию для преодоления трудностей."
         data-zh="马自达受美国加征进口汽车关税影响，季度净亏损达2.86亿美元，预计本财年净利润将大幅下降，正在调整出口策略以应对挑战。" data-en="Mazda reported a quarterly net loss of $286 million due to the impact of U.S. import tariffs on automobiles, with expected significant declines in net profit for the current fiscal year. The company is adjusting its export strategy to address these challenges.">
        Mazda пострадала от повышения США импортных пошлин на автомобили, квартальный чистый убыток составил 286 миллионов долларов. Ожидается, что чистая прибыль за текущий финансовый год значительно снизится. Компания корректирует экспортную стратегию для преодоления трудностей.
        <a href="https://auto.gasgoo.com/news/202508/6I70430835C109.shtml" class="source-link" style="display: inline-block; margin-top: 15px;">↗</a>
    </div>
</article>


<footer>
    <p id="copyrightText">Авторское право © Atom 2025. Все права защищены</p>
    <p id="updateText">Последнее обновление: 2025-08-06 06:01:53</p>
</footer>

<!-- 返回顶部按钮 -->
<button id="back-to-top" title="返回顶部"><i class="fas fa-arrow-up"></i></button>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // 初始化所有功能
        initializeGalleries();
        initializeLanguage();
        initializeTheme();
        initializeImageFullscreen();
        // 初始化滚动相关功能
        initializeScrollFeatures();
    });

    // --- 主题初始化 ---
    function initializeTheme() {
        const themeSelect = document.getElementById('themeSelect');
        const savedTheme = localStorage.getItem('selectedTheme') || 'light';
        applyTheme(savedTheme);
        themeSelect.value = savedTheme;
        themeSelect.addEventListener('change', function() {
            const newTheme = this.value;
            applyTheme(newTheme);
            localStorage.setItem('selectedTheme', newTheme);
        });
    }

    function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
    }

    // --- 语言初始化 ---
    function initializeLanguage() {
        const languageSelect = document.getElementById('languageSelect');
        const savedLang = localStorage.getItem('selectedLanguage') || 'ru';
        languageSelect.value = savedLang;
        applyLanguage(savedLang);
        languageSelect.addEventListener('change', function() {
            const lang = this.value;
            localStorage.setItem('selectedLanguage', lang);
            applyLanguage(lang);
        });
    }

    // --- 滚动特性初始化 ---
    function initializeScrollFeatures() {
        const topControls = document.getElementById('top-controls');
        const mainHeader = document.getElementById('main-header');
        const backToTopButton = document.getElementById('back-to-top');
        // 计算触发固定的滚动阈值（头部下方）
        const scrollThreshold = mainHeader.offsetTop + mainHeader.offsetHeight;

        window.addEventListener('scroll', () => {
            // 浮动控制面板逻辑
            if (window.scrollY > scrollThreshold) {
                topControls.classList.add('sticky');
            } else {
                topControls.classList.remove('sticky');
            }

            // 返回顶部按钮逻辑
            if (window.scrollY > 300) { // 滚动超过300px时显示
                backToTopButton.classList.add('show');
            } else {
                backToTopButton.classList.remove('show');
            }
        }, { passive: true }); // 使用被动监听器提高性能

        // 返回顶部按钮的点击事件
        backToTopButton.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth' // 平滑滚动效果
            });
        });
    }

    // --- 画廊初始化 ---
    function initializeGalleries() {
        document.querySelectorAll('.image-gallery').forEach(gallery => {
            const galleryId = gallery.id;
            const indicatorsContainer = document.getElementById(`indicators-${galleryId.split('-')[1]}`);
            const imageContainers = gallery.querySelectorAll('.image-container');
            const imageCount = imageContainers.length;

            if (imageCount === 0 || !indicatorsContainer) return;

            // 仅当图片数量大于1时，才显示箭头和指示器
            const navContainer = gallery.closest('.image-gallery-container');
            if (imageCount <= 1) {
                navContainer.querySelector('.gallery-nav.prev').style.display = 'none';
                navContainer.querySelector('.gallery-nav.next').style.display = 'none';
                indicatorsContainer.style.display = 'none';
                return; // 如果只有一张图片则退出，不进行后续设置
            }

            indicatorsContainer.innerHTML = '';
            for (let i = 0; i < imageCount; i++) {
                const indicator = document.createElement('div');
                indicator.classList.add('indicator');
                if (i === 0) indicator.classList.add('active');
                indicator.onclick = () => showImage(galleryId, i);
                indicatorsContainer.appendChild(indicator);
            }

            resetAutoScroll(gallery);

            let scrollTimer;
            gallery.addEventListener('scroll', () => {
                 clearTimeout(scrollTimer);
                 scrollTimer = setTimeout(() => {
                      updateIndicators(galleryId);
                 }, 150);
            }, { passive: true });
        });
    }

    // --- 图片全屏功能初始化 ---
    function initializeImageFullscreen() {
        document.querySelectorAll('.image-container img').forEach(img => {
            img.addEventListener('click', () => {
                const fullscreen = document.createElement('div');
                fullscreen.className = 'fullscreen-image';
                fullscreen.innerHTML = `<img src="${img.src}" alt="fullscreen image">`;
                document.body.appendChild(fullscreen);
                fullscreen.addEventListener('click', () => {
                    fullscreen.remove();
                });
            });
        });
    }

    // --- 画廊功能函数 ---
    function getCurrentImageIndex(galleryId) {
        const gallery = document.getElementById(galleryId);
        if (!gallery || gallery.children.length === 0) return 0;
        const scrollLeft = gallery.scrollLeft;
        const itemWidth = gallery.children[0].getBoundingClientRect().width;
        const gap = parseInt(getComputedStyle(gallery).gap) || 0;
        return Math.round(scrollLeft / (itemWidth + gap));
    }

    function showImage(galleryId, index) {
        const gallery = document.getElementById(galleryId);
        const image = gallery.children[index];
        if (!image) return;

        // 平滑滚动到目标图片
        gallery.scrollTo({
            left: image.offsetLeft,
            behavior: 'smooth'
        });

        resetAutoScroll(gallery);
    }

    function scrollGallery(galleryId, direction) {
        const gallery = document.getElementById(galleryId);
        const currentIndex = getCurrentImageIndex(galleryId);
        let newIndex = currentIndex + direction;

        if (newIndex >= gallery.children.length) {
             newIndex = 0;
        } else if (newIndex < 0) {
             newIndex = gallery.children.length - 1;
        }
        showImage(galleryId, newIndex);
    }

    function resetAutoScroll(gallery) {
        clearInterval(gallery.dataset.autoScroll);
        gallery.dataset.autoScroll = setInterval(() => {
            scrollGallery(gallery.id, 1);
        }, 5000);
    }

    function updateIndicators(galleryId) {
        const indicatorsContainer = document.getElementById(`indicators-${galleryId.split('-')[1]}`);
        if (!indicatorsContainer) return;
        const activeIndex = getCurrentImageIndex(galleryId);
        indicatorsContainer.querySelectorAll('.indicator').forEach((dot, index) => {
            dot.classList.toggle('active', index === activeIndex);
        });
    }

    // --- 语言应用核心函数 ---
    function applyLanguage(lang) {
        const langMap = {'ru': 'ru-RU', 'zh': 'zh-CN', 'en': 'en-US'};
        document.documentElement.lang = langMap[lang] || 'ru-RU';

        document.querySelectorAll('[data-ru]').forEach(element => {
            if (element.dataset[lang]) {
                if (element.classList.contains('news-content')) {
                    const link = element.querySelector('.source-link');
                    element.innerHTML = element.dataset[lang];
                    if (link) element.appendChild(link.cloneNode(true));
                } else if (element.classList.contains('highlight-item')) {
                    const link = element.querySelector('.source-link');
                    const linkHref = link ? link.href : '#';
                    element.innerHTML = `${element.dataset[lang]} <a href="${linkHref}" class="source-link">↗</a>`;
                } else {
                    // 这个通用逻辑会正确处理 stats-bar 中的 span 元素
                    element.textContent = element.dataset[lang];
                }
            }
        });

        document.querySelectorAll('#themeSelect option').forEach(option => {
            if (option.dataset[lang]) {
                option.textContent = option.dataset[lang];
            }
        });

        const translations = {
            ru: {
                highlights: "Основные моменты",
                copyright: "Авторское право © Atom 2025. Все права защищены",
                updated: "Последнее обновление: "
            },
            zh: {
                highlights: "重点内容",
                copyright: "版权所有 © Atom 2025。保留所有权利",
                updated: "最后更新: "
            },
            en: {
                highlights: "Highlights",
                copyright: "Copyright © Atom 2025. All Rights Reserved",
                updated: "Last updated: "
            }
        };

        const highlightsText = document.getElementById('highlightsText');
        const copyrightText = document.getElementById('copyrightText');
        const updateText = document.getElementById('updateText');

        if (highlightsText) highlightsText.textContent = translations[lang].highlights;
        if (copyrightText) copyrightText.textContent = translations[lang].copyright;
        if (updateText) {
            updateText.textContent = translations[lang].updated + '2025-08-06 06:01:53';
        }

        const categorySummary = document.getElementById('categorySummary');
        if (categorySummary) {
            switch(lang) {
                case 'ru':
                    categorySummary.textContent = "Автомобильная отрасль сталкивается с вызовами из-за тарифов и норм выбросов.";
                    break;
                case 'zh':
                    categorySummary.textContent = "汽车行业受关税和排放法规影响面临挑战。";
                    break;
                case 'en':
                    categorySummary.textContent = "The automotive industry faces challenges due to tariffs and emission regulations.";
                    break;
            }
        }
    }
</script>
</body>
</html>